<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>House and Order Management</title>    <!-- Thêm các thư viện CSS và JavaScript cần thiết -->    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet"/>    <!-- Core theme CSS (includes Bootstrap)-->    <link href="/css/styles.css" rel="stylesheet"/>    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.slim.min.js"></script>    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script></head><body><!-- Header --><nav class="navbar navbar-expand-lg navbar-light bg-light">    <div class="container px-4 px-lg-5">        <a class="navbar-brand" href="#!">House Listings</a>        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">            <span class="navbar-toggler-icon"></span>        </button>        <div class="collapse navbar-collapse" id="navbarSupportedContent">            <ul class="navbar-nav me-auto mb-2 mb-lg-0 ms-lg-4">            </ul>            <ul class="navbar-nav ml-auto">                <li class="nav-item dropdown" th:if="${#httpServletRequest.remoteUser != null}">                    <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"                       data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">                        <i class="bi bi-person-circle"></i> <span                            th:text="${#httpServletRequest.remoteUser}">Username</span>                    </a>                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">                        <div class="dropdown-divider"></div>                        <a class="dropdown-item" href="/logout">Logout</a>                    </div>                </li>                <li class="nav-item" th:if="${#httpServletRequest.remoteUser == null}">                    <a class="nav-link" href="/login">Đăng nhập</a>                </li>                <li class="nav-item" th:if="${#httpServletRequest.remoteUser == null}">                    <a class="nav-link" href="/register">Đăng ký</a>                </li>            </ul>        </div>    </div></nav><br><div class="container mt-3">    <h2>Chào mừng bạn đến mới trang của Owner</h2>    <br>    <!-- Nav tabs -->    <ul class="nav nav-tabs">        <li class="nav-item">            <a class="nav-link active" data-toggle="tab" href="#home">Manage Houses</a>        </li>        <li class="nav-item">            <a class="nav-link" data-toggle="tab" href="#menu1">Manage Bookings</a>        </li>    </ul>    <!-- Tab panes -->    <div class="tab-content">        <div id="home" class="container tab-pane active"><br>            <section id="houses">                <h2>Manage Houses</h2>                <button class="btn btn-primary mb-3" data-toggle="modal" data-target="#addHouseModal">Add New House                </button>                <table class="table table-bordered">                    <thead>                    <tr>                        <th>ID</th>                        <th>Name</th>                        <th>Address</th>                        <th>Service</th>                        <th>Price</th>                        <th>Sale</th>                        <th>Thumbnail</th>                        <th>Status</th>                        <th>Create At</th>                        <th>Update At</th>                        <th>Actions</th>                    </tr>                    </thead>                    <tbody>                    <tr th:each="house : ${houses}">                        <td th:text="${house.id}"></td>                        <td><a th:href="@{/houses/{id} (id=${house.id})}" th:text="${house.name}"></a></td>                        <td th:text="${house.address}"></td>                        <td th:text="${house.service}"></td>                        <td th:text="${house.price}"></td>                        <td th:text="${house.sale}"></td>                        <td><img th:src="@{${house.thumbnail}}" alt="Thumbnail" style="width: 100px;"></td>                        <td th:if='${house.status.equals("Đang hoạt động")}' style="color: forestgreen"                            th:text="${house.status}"></td>                        <td th:if='${house.status.equals("Đã khóa")}' style="color: red" th:text="${house.status}"></td>                        <td th:text="${house.createAt}"></td>                        <td th:text="${house.updateAt}"></td>                        <td>                            <button class="btn btn-sm btn-info" data-toggle="modal" data-target="#editHouseModal"                                    th:data-id="${house.id}" onclick="editHouse(this)">Edit                            </button>                            <button th:if='${house.status.equals("Đang hoạt động")}' class="btn btn-sm btn-danger"                                    th:data-id="${house.id}"                                    data-toggle="modal" data-target="#deleteHouseModal"                                    onclick="deleteHouse(this)">Khóa                            </button>                            <button th:if='${house.status.equals("Đã khóa")}' class="btn btn-sm btn-success"                                    th:data-id="${house.id}"                                    data-toggle="modal" data-target="#deleteHouseModal"                                    onclick="deleteHouse(this)">Mở khóa                            </button>                        </td>                    </tr>                    </tbody>                </table>            </section>        </div>        <div id="menu1" class="container tab-pane fade"><br>            <section id="bookings">                <h2>Manage Bookings</h2>                <table class="table table-bordered">                    <thead>                    <tr>                        <th>ID</th>                        <th>Start Time</th>                        <th>Status</th>                        <th>Content</th>                        <th>Result</th>                        <th>Create At</th>                        <th>House</th>                        <th>Account</th>                        <th>Actions</th>                    </tr>                    </thead>                    <tbody>                    <tr th:each="booking : ${bookings}">                        <td th:text="${booking.id}"></td>                        <td th:text="${booking.startTime}"></td>                        <td th:if='${!booking.status.equals("đã hủy")}' style="color: #0d6efd" th:text="${booking.status}"></td>                        <td th:if='${booking.status.equals("đã hủy")}' style="color: red" th:text="${booking.status}"></td>                        <td th:text="${booking.content}"></td>                        <td th:text="${booking.result}"></td>                        <td th:text="${booking.create_at}"></td>                        <td><a th:href="@{/houses/{id} (id=${booking.house.id})}" th:text="${booking.house.name}"></a></td>                        <td th:text="${booking.account.username}"></td>                        <td>                            <button th:if='${booking.status.equals("chờ xác nhận")}' class="btn btn-sm btn-success"                                    data-toggle="modal" data-target="#successBookingModal"                                    th:data-id="${booking.id}"                                    onclick="successBooking(this)">Xác nhận                            </button>                            <button th:if='${!booking.status.equals("đã xong") && !booking.status.equals("đã hủy")}'                                    class="btn btn-sm btn-danger" data-toggle="modal" data-target="#cancelBookingModal"                                    th:data-id="${booking.id}"                                    onclick="cancelBooking(this)">Hủy                            </button>                        </td>                    </tr>                    </tbody>                </table>            </section>        </div>    </div></div><!-- Add House Modal --><div class="modal fade" id="addHouseModal" tabindex="-1" role="dialog" aria-labelledby="addHouseModalLabel"     aria-hidden="true">    <div class="modal-dialog" role="document">        <div class="modal-content">            <div class="modal-header">                <h5 class="modal-title" id="addHouseModalLabel">Add New House</h5>                <button type="button" class="close" data-dismiss="modal" aria-label="Close">                    <span aria-hidden="true">&times;</span>                </button>            </div>            <div class="modal-body">                <!-- Add House Form -->                <form id="addHouseForm" action="/houses" method="post" enctype="multipart/form-data">                    <!-- Form fields go here -->                    <div class="form-group">                        <label for="houseName">Name</label>                        <input type="text" class="form-control" id="houseName" name="name" required>                    </div>                    <div class="form-group">                        <label for="houseAddress">Address</label>                        <input type="text" class="form-control" id="houseAddress" name="address" required>                    </div>                    <div class="form-group">                        <label for="houseDescription">Description</label>                        <input type="text" class="form-control" id="houseDescription" name="description" required>                    </div>                    <div class="form-group">                        <label for="houseService">Service</label>                        <input type="text" class="form-control" id="houseService" name="service" required>                    </div>                    <div class="form-group">                        <label for="housePrice">Price</label>                        <input type="number" class="form-control" id="housePrice" name="price" required>                    </div>                    <div class="form-group">                        <label for="houseSale">Sale</label>                        <input type="text" class="form-control" id="houseSale" name="sale" required>                    </div>                    <div class="form-group">                        <label for="houseThumbnail">Thumbnail</label>                        <input type="file" class="form-control" id="houseThumbnail" name="imgFiles" multiple required>                    </div>                    <div class="form-group">                        <label for="houseStatus">Status</label>                        <input type="text" class="form-control" id="houseStatus" name="status" required>                    </div>                </form>            </div>            <div class="modal-footer">                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>                <button type="button" class="btn btn-primary" onclick="saveHouse()">Save</button>            </div>        </div>    </div></div><!-- Edit House Modal --><div class="modal fade" id="editHouseModal" tabindex="-1" role="dialog" aria-labelledby="editHouseModalLabel"     aria-hidden="true">    <div class="modal-dialog" role="document">        <div class="modal-content">            <div class="modal-header">                <h5 class="modal-title" id="editHouseModalLabel">Edit House</h5>                <button type="button" class="close" data-dismiss="modal" aria-label="Close">                    <span aria-hidden="true">&times;</span>                </button>            </div>            <div class="modal-body">                <!-- Edit House Form -->                <form id="editHouseForm" action="/houses" method="post" enctype="multipart/form-data">                    <!-- Form fields go here (similar to Add House Form) -->                    <!-- Hidden field for house ID -->                    <input type="hidden" id="editHouseId" name="id">                    <!-- Similar form fields as Add House Form -->                    <div class="form-group">                        <label for="editHouseName">Name</label>                        <input type="text" class="form-control" id="editHouseName" name="name" required>                    </div>                    <div class="form-group">                        <label for="editHouseAddress">Address</label>                        <input type="text" class="form-control" id="editHouseAddress" name="address" required>                    </div>                    <div class="form-group">                        <label for="editHouseDescription">Description</label>                        <input type="text" class="form-control" id="editHouseDescription" name="description" required>                    </div>                    <div class="form-group">                        <label for="editHouseService">Service</label>                        <input type="text" class="form-control" id="editHouseService" name="service" required>                    </div>                    <div class="form-group">                        <label for="editHousePrice">Price</label>                        <input type="number" class="form-control" id="editHousePrice" name="price" required>                    </div>                    <div class="form-group">                        <label for="editHouseSale">Sale</label>                        <input type="text" class="form-control" id="editHouseSale" name="sale" required>                    </div>                    <div class="form-group">                        <label for="editHouseThumbnail">Thumbnail</label>                        <input type="file" class="form-control" id="editHouseThumbnail" name="imgFiles" multiple                               required>                    </div>                    <div class="form-group">                        <label for="editHouseStatus">Status</label>                        <input type="text" class="form-control" id="editHouseStatus" name="status" required>                    </div>                </form>            </div>            <div class="modal-footer">                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>                <button type="button" class="btn btn-primary" onclick="updateHouse()">Save Changes</button>            </div>        </div>    </div></div><!-- Delete House Modal --><div class="modal fade" id="deleteHouseModal" tabindex="-1" role="dialog" aria-labelledby="deleteHouseModalLabel"     aria-hidden="true">    <div class="modal-dialog" role="document">        <div class="modal-content">            <div class="modal-header">                <h5 class="modal-title" id="deleteHouseModalLabel">Khóa/Mở House</h5>                <button type="button" class="close" data-dismiss="modal" aria-label="Close">                    <span aria-hidden="true">&times;</span>                </button>            </div>            <div class="modal-body">                <p>Bạn chắc chắn chứ?</p>                <!-- Hidden field for house ID -->                <form id="blockHouseForm" action="/owner/block" method="post">                    <input type="hidden" id="deleteHouseId" name="id">                </form>            </div>            <div class="modal-footer">                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>                <button type="button" class="btn btn-primary" onclick="confirmDeleteHouse()">Submit</button>            </div>        </div>    </div></div><!-- Cancel Booking Modal --><div class="modal fade" id="cancelBookingModal" tabindex="-1" role="dialog" aria-labelledby="cancelBookingModalLabel"     aria-hidden="true">    <div class="modal-dialog" role="document">        <div class="modal-content">            <div class="modal-header">                <h5 class="modal-title" id="cancelBookingModalLabel">Cancel Booking</h5>                <button type="button" class="close" data-dismiss="modal" aria-label="Close">                    <span aria-hidden="true">&times;</span>                </button>            </div>            <div class="modal-body">                <p>Are you sure you want to cancel this booking?</p>                <form action="/owner/cancel-booking" method="post" id="cancelBooking">                    <input type="hidden" id="cancelBookingId" name="id">                    <input name="message" placeholder="Nhập nội dung hủy">                </form>                <!-- Hidden field for booking ID -->            </div>            <div class="modal-footer">                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>                <button type="button" class="btn btn-danger" onclick="confirmCancelBooking()">Cancel</button>            </div>        </div>    </div></div><!--success--><div class="modal fade" id="successBookingModal" tabindex="-1" role="dialog" aria-labelledby="successBookingModalLabel"     aria-hidden="true">    <div class="modal-dialog" role="document">        <div class="modal-content">            <div class="modal-header">                <h5 class="modal-title" id="successBookingModalLabel">Success Booking</h5>                <button type="button" class="close" data-dismiss="modal" aria-label="Close">                    <span aria-hidden="true">&times;</span>                </button>            </div>            <div class="modal-body">                <p>Bạn chắc chắn chấp nhập booking này?</p>                <form action="/owner/success-booking" method="post" id="successBooking">                    <input type="hidden" id="successBookingId" name="id">                </form>                <!-- Hidden field for booking ID -->            </div>            <div class="modal-footer">                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>                <button type="button" class="btn btn-success" onclick="confirmSuccessBooking()">Success</button>            </div>        </div>    </div></div><script>    function editHouse(button) {        const id = button.getAttribute("data-id");        // Gửi yêu cầu AJAX để lấy dữ liệu nhà từ server        $.ajax({            url: '/houses/api/' + id, // URL API để lấy dữ liệu nhà theo ID            type: 'GET',            success: function (house) {                // Điền dữ liệu nhà vào form chỉnh sửa                $('#editHouseId').val(house.id);                $('#editHouseName').val(house.name);                $('#editHouseAddress').val(house.address);                $('#editHouseDescription').val(house.description);                $('#editHouseService').val(house.service);                $('#editHousePrice').val(house.price);                $('#editHouseSale').val(house.sale);                $('#editHouseStatus').val(house.status);            },            error: function (xhr, status, error) {                // Xử lý lỗi nếu có                console.error('Error fetching house data:', error);            }        });    }    function deleteHouse(button) {        const id = button.getAttribute("data-id");        $('#deleteHouseId').val(id);    }    function cancelBooking(button) {        const id = button.getAttribute("data-id");        $('#cancelBookingId').val(id);    }    function successBooking(button) {        const id = button.getAttribute("data-id");        $('#successBookingId').val(id);    }    function saveHouse() {        // Submit add house form        $('#addHouseForm').submit();    }    function updateHouse() {        // Submit edit house form        $('#editHouseForm').submit();    }    function confirmDeleteHouse() {        $('#blockHouseForm').submit();    }    function confirmCancelBooking() {        $('#cancelBooking').submit();    }    function confirmSuccessBooking() {        $('#successBooking').submit();    }</script></body></html><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>